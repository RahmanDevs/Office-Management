<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Number to Word Converter</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;600&display=swap" rel="stylesheet">
    <style>
        @font-face {
            font-family: 'SutonnyMJ';
            src: url('https://cdnjs.cloudflare.com/ajax/libs/bangla-web-fonts/1.0.0/SutonnyMJ.ttf') format('truetype');
            font-weight: normal;
            font-style: normal;
        }
    </style>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Roboto', sans-serif;
            background: #f4f7fa;
            color: #2c3e50;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        .page-wrapper {
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        header {
            background: #2c3e50;
            color: white;
            text-align: center;
            padding: 30px 20px;
        }

        header h1 {
            font-size: 28px;
            font-weight: 600;
            margin-bottom: 10px;
        }

        header p {
            font-size: 16px;
            opacity: 0.9;
        }

        .container {
            max-width: 900px;
            width: 100%;
            margin: 40px auto;
            padding: 0 20px;
            flex: 1;
        }

        .converter-panel {
            background: white;
            border-radius: 10px;
            padding: 30px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            margin-bottom: 30px;
        }

        .info-box {
            background: #e8f4f8;
            border-radius: 8px;
            padding: 15px;
            color: #2c3e50;
            display: flex;
            align-items: start;
            gap: 12px;
            margin-bottom: 25px;
            font-size: 14px;
        }

        .info-box-icon {
            font-size: 20px;
            flex-shrink: 0;
        }

        .input-group {
            margin-bottom: 25px;
        }

        .input-group label {
            display: block;
            font-weight: 600;
            margin-bottom: 8px;
            font-size: 14px;
            color: #2c3e50;
        }

        .input-group input {
            width: 100%;
            border: 2px solid #ecf0f1;
            border-radius: 5px;
            padding: 12px;
            font-size: 16px;
            font-family: 'Roboto', sans-serif;
            transition: border-color 0.3s;
        }

        .input-group input:focus {
            outline: none;
            border-color: #3498db;
        }

        .segmented-control {
            background: #e0e0e0;
            border-radius: 30px;
            padding: 6px;
            display: inline-flex;
            gap: 4px;
            box-shadow: inset 0 0 5px rgba(0, 0, 0, 0.1);
            margin-bottom: 25px;
            width: 100%;
        }

        .segmented-control button {
            flex: 1;
            background: transparent;
            border: none;
            padding: 12px 20px;
            border-radius: 24px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            color: #2c3e50;
        }

        .segmented-control button:hover:not(.active) {
            background: #c5d9f7;
        }

        .segmented-control button.active {
            background: #3498db;
            color: white;
            box-shadow: 0 2px 8px rgba(52, 152, 219, 0.4);
        }

        .convert-btn {
            background: #3498db;
            color: white;
            padding: 14px 40px;
            border-radius: 30px;
            border: none;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            width: 100%;
            margin-bottom: 20px;
        }

        .convert-btn:hover {
            background: #2980b9;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(52, 152, 219, 0.3);
        }

        .convert-btn:active {
            transform: translateY(0);
        }

        .clear-btn {
            background: #ecf0f1;
            color: #2c3e50;
            padding: 12px 30px;
            border-radius: 30px;
            border: none;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            width: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .clear-btn:hover {
            background: #d5d8dc;
            transform: translateY(-2px);
        }

        .clear-btn:active {
            transform: translateY(0);
        }

        .result-panel {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(44, 62, 80, 0.85);
            backdrop-filter: blur(8px);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            padding: 20px;
        }

        .result-panel.show {
            display: flex;
            animation: fadeInBackdrop 0.3s ease;
        }

        @keyframes fadeInBackdrop {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }

        .result-card {
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            max-width: 600px;
            width: 100%;
            max-height: 80vh;
            overflow-y: auto;
            position: relative;
            animation: slideUpScale 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        @keyframes slideUpScale {
            from {
                opacity: 0;
                transform: translateY(50px) scale(0.9);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        .close-popup {
            position: absolute;
            top: 15px;
            right: 15px;
            background: #ecf0f1;
            border: none;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            font-size: 20px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
            color: #2c3e50;
        }

        .close-popup:hover {
            background: #e74c3c;
            color: white;
            transform: rotate(90deg);
        }

        .result-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 25px;
            padding-bottom: 20px;
            border-bottom: 3px solid #3498db;
        }

        .result-header-icon {
            font-size: 40px;
            animation: bounceIn 0.6s ease;
        }

        @keyframes bounceIn {
            0% {
                transform: scale(0);
            }
            50% {
                transform: scale(1.2);
            }
            100% {
                transform: scale(1);
            }
        }

        .result-header h3 {
            font-size: 24px;
            color: #2c3e50;
            margin: 0;
        }

        .result-content {
            padding: 25px;
            background: linear-gradient(135deg, #f8f9fa 0%, #e8f4f8 100%);
            border-radius: 12px;
            border-left: 5px solid #3498db;
            margin-bottom: 20px;
            animation: slideIn 0.5s ease 0.2s both;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateX(-20px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .result-label {
            font-size: 13px;
            font-weight: 600;
            color: #3498db;
            text-transform: uppercase;
            margin-bottom: 12px;
            letter-spacing: 0.5px;
        }

        .result-text {
            font-size: 20px;
            color: #2c3e50;
            line-height: 1.8;
            word-wrap: break-word;
            font-weight: 500;
        }

        .result-text.bangla-ansi {
            font-family: 'SutonnyMJ', 'Roboto', sans-serif;
            font-size: 22px;
        }

        .result-actions {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            animation: fadeInUp 0.5s ease 0.3s both;
        }

        .result-actions .close-btn {
            grid-column: 1 / -1;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .copy-btn {
            background: #3498db;
            color: white;
            padding: 12px 24px;
            border-radius: 8px;
            border: none;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            flex: 1;
        }

        .copy-btn:hover {
            background: #2980b9;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(52, 152, 219, 0.4);
        }

        .copy-btn:active {
            transform: translateY(0);
        }

        .copy-btn.copied {
            background: #27ae60;
        }

        .copy-btn.number-btn {
            background: #27ae60;
        }

        .copy-btn.number-btn:hover {
            background: #229954;
        }

        .copy-btn.number-btn.copied {
            background: #16a085;
        }

        .close-btn {
            background: #ecf0f1;
            color: #2c3e50;
            padding: 12px 24px;
            border-radius: 8px;
            border: none;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            flex: 1;
        }

        .close-btn:hover {
            background: #d5d8dc;
            transform: translateY(-2px);
        }

        .close-btn:active {
            transform: translateY(0);
        }

        .error-message {
            background: #fee;
            border-left: 4px solid #e74c3c;
            color: #c0392b;
            padding: 15px;
            border-radius: 5px;
            margin-top: 15px;
            display: none;
        }

        .error-message.show {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        footer {
            background: #2c3e50;
            color: white;
            text-align: center;
            padding: 15px 0;
            font-size: 14px;
            margin-top: auto;
        }

            @media (max-width: 768px) {
            .container {
                margin: 20px auto;
            }

            .converter-panel,
            .result-card {
                padding: 20px;
            }

            header h1 {
                font-size: 24px;
            }

            .segmented-control {
                flex-direction: column;
                border-radius: 10px;
            }

            .segmented-control button {
                border-radius: 8px;
            }

            .result-actions {
                grid-template-columns: 1fr;
            }

            .result-card {
                max-height: 90vh;
            }
        }
    </style>
</head>
<body>
    <div class="page-wrapper">
        <header>
            <h1>üî¢ Number to Word Converter</h1>
            <p>Convert numbers to words in Bangla Unicode, English, and Bangla ANSI</p>
        </header>

        <div class="container">
            <div class="converter-panel">
                <div class="info-box">
                    <span class="info-box-icon">üí°</span>
                    <div>
                        <strong>How to use:</strong> Enter any number (up to 999 crore) and select your preferred output format. Bangla formats support Taka/Poysa notation for decimal values.
                    </div>
                </div>

                <div class="input-group">
                    <label for="numberInput">Enter Number</label>
                    <input 
                        type="text" 
                        id="numberInput" 
                        placeholder="e.g., 12345 or 123.45"
                        autocomplete="off"
                    >
                </div>

                <div class="input-group">
                    <label>Select Output Format</label>
                    <div class="segmented-control">
                        <button class="active" data-format="bangla-unicode">Bangla Unicode</button>
                        <button data-format="english">English</button>
                        <button data-format="bangla-ansi">Bangla ANSI</button>
                    </div>
                </div>

                <div class="input-group">
                    <label>Number Display Format</label>
                    <div class="segmented-control">
                        <button class="active" data-number-format="plain" onclick="selectNumberFormat('plain')">9999</button>
                        <button data-number-format="comma" onclick="selectNumberFormat('comma')">9,999</button>
                        <button data-number-format="comma-slash" onclick="selectNumberFormat('comma-slash')">9,999/-</button>
                        <button data-number-format="slash" onclick="selectNumberFormat('slash')">9999/-</button>
                        <button data-number-format="taka" onclick="selectNumberFormat('taka')">‡ß≥9,999</button>
                    </div>
                </div>

                <button class="convert-btn" onclick="convertNumber()">Convert to Words</button>

                <button class="clear-btn" onclick="clearForm()">
                    <span>üóëÔ∏è</span>
                    <span>Clear All</span>
                </button>

                <div class="error-message" id="errorMessage"></div>
            </div>

            <div class="result-panel" id="resultPanel" onclick="closePopupOnBackdrop(event)">
                <div class="result-card">
                    <button class="close-popup" onclick="closePopup()">‚úï</button>
                    
                    <div class="result-header">
                        <span class="result-header-icon">‚ú®</span>
                        <h3>Conversion Result</h3>
                    </div>

                    <div class="result-content">
                        <div class="result-label">Original Number</div>
                        <div class="result-text" id="resultNumber" style="font-size: 28px; font-weight: 600; color: #3498db; margin-bottom: 20px;"></div>
                        
                        <div class="result-label" id="resultLabel">Bangla Unicode</div>
                        <div class="result-text" id="resultText"></div>
                    </div>

                    <div class="result-actions">
                        <button class="copy-btn" onclick="copyResult()">
                            <span id="copyIcon">üìã</span>
                            <span id="copyText">Copy Words</span>
                        </button>
                        <button class="copy-btn" onclick="copyNumber()" style="background: #27ae60;">
                            <span id="copyNumberIcon">üî¢</span>
                            <span id="copyNumberText">Copy Number</span>
                        </button>
                        <button class="close-btn" onclick="closePopup()">
                            <span>‚úì</span>
                            <span>Close</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <footer>
            ¬© 2025 Number Converter | All rights reserved.
        </footer>
    </div>

    <script>
        // State management with localStorage persistence
        let currentFormat = 'bangla-unicode';
        let currentNumberFormat = 'plain';
        let currentNumberLang = 'english';
        let lastResult = '';
        let lastNumber = '';

        // Bangla digit mappings
        const banglaUnicodeDigits = ['‡ß¶', '‡ßß', '‡ß®', '‡ß©', '‡ß™', '‡ß´', '‡ß¨', '‡ß≠', '‡ßÆ', '‡ßØ'];
        const banglaAnsiDigits = ['‡ß¶', '‡ßß', '‡ß®', '‡ß©', '‡ß™', '‡ß´', '‡ß¨', '‡ß≠', '‡ßÆ', '‡ßØ'];

        // Initialize: Load saved format from localStorage on page load
        window.addEventListener('DOMContentLoaded', function() {
            const savedFormat = localStorage.getItem('numberConverterFormat');
            const savedNumberFormat = localStorage.getItem('numberDisplayFormat');
            const savedNumberLang = localStorage.getItem('numberLanguage');
            
            if (savedFormat) {
                currentFormat = savedFormat;
                updateActiveButton(currentFormat);
            }
            
            if (savedNumberFormat) {
                currentNumberFormat = savedNumberFormat;
                updateActiveNumberFormatButton(currentNumberFormat);
            }
            
            if (savedNumberLang) {
                currentNumberLang = savedNumberLang;
                updateActiveNumberLangButton(savedNumberLang);
            }
        });

        function updateActiveButton(format) {
            document.querySelectorAll('.segmented-control button[data-format]').forEach(btn => {
                btn.classList.remove('active');
                if (btn.dataset.format === format) {
                    btn.classList.add('active');
                }
            });
        }

        function updateActiveNumberFormatButton(format) {
            document.querySelectorAll('.segmented-control button[data-number-format]').forEach(btn => {
                btn.classList.remove('active');
                if (btn.dataset.numberFormat === format) {
                    btn.classList.add('active');
                }
            });
        }

        function updateActiveNumberLangButton(lang) {
            document.querySelectorAll('.segmented-control button[data-number-lang]').forEach(btn => {
                btn.classList.remove('active');
                if (btn.dataset.numberLang === lang) {
                    btn.classList.add('active');
                }
            });
        }

        function saveFormat(format) {
            currentFormat = format;
            localStorage.setItem('numberConverterFormat', format);
        }

        function selectNumberFormat(format) {
            currentNumberFormat = format;
            localStorage.setItem('numberDisplayFormat', format);
            updateActiveNumberFormatButton(format);
            
            // Update display if result is showing
            if (lastNumber) {
                document.getElementById('resultNumber').textContent = formatNumber(lastNumber);
            }
        }

        function selectNumberLang(lang) {
            currentNumberLang = lang;
            localStorage.setItem('numberLanguage', lang);
            updateActiveNumberLangButton(lang);
            
            // Update display if result is showing
            if (lastNumber) {
                const resultNumElement = document.getElementById('resultNumber');
                resultNumElement.textContent = formatNumber(lastNumber);
                
                // Apply SutonnyMJ font for Bangla ANSI numbers
                if (lang === 'bangla-ansi') {
                    resultNumElement.style.fontFamily = "'SutonnyMJ', 'Roboto', sans-serif";
                } else {
                    resultNumElement.style.fontFamily = "'Roboto', sans-serif";
                }
            }
        }

        function convertToNumberLang(numStr) {
            if (currentNumberLang === 'english') {
                return numStr;
            }
            
            const digits = currentNumberLang === 'bangla-unicode' ? banglaUnicodeDigits : banglaAnsiDigits;
            let result = '';
            
            for (let char of numStr) {
                if (char >= '0' && char <= '9') {
                    result += digits[parseInt(char)];
                } else {
                    result += char;
                }
            }
            
            return result;
        }

        function formatNumber(num) {
            const numStr = num.toString();
            let formatted = '';
            
            switch(currentNumberFormat) {
                case 'plain':
                    formatted = numStr;
                    break;
                
                case 'comma':
                    const parts = numStr.split('.');
                    let intPart = parts[0];
                    const decPart = parts[1] ? '.' + parts[1] : '';
                    
                    let lastThree = intPart.substring(intPart.length - 3);
                    let otherNumbers = intPart.substring(0, intPart.length - 3);
                    
                    if (otherNumbers !== '') {
                        lastThree = ', ' + lastThree;
                    }
                    
                    let result = otherNumbers.replace(/\B(?=(\d{2})+(?!\d))/g, ', ') + lastThree;
                    formatted = result + decPart;
                    break;
                
                case 'slash':
                    formatted = numStr + '/-';
                    break;
                
                case 'taka':
                    const commaParts = numStr.split('.');
                    let commaIntPart = commaParts[0];
                    const commaDecPart = commaParts[1] ? '.' + commaParts[1] : '';
                    
                    let lastThreeComma = commaIntPart.substring(commaIntPart.length - 3);
                    let otherNumbersComma = commaIntPart.substring(0, commaIntPart.length - 3);
                    
                    if (otherNumbersComma !== '') {
                        lastThreeComma = ', ' + lastThreeComma;
                    }
                    
                    let commaResult = otherNumbersComma.replace(/\B(?=(\d{2})+(?!\d))/g, ', ') + lastThreeComma;
                    formatted = '‡ß≥' + commaResult + commaDecPart;
                    break;
                
                default:
                    formatted = numStr;
            }
            
            // Convert to selected number language
            return convertToNumberLang(formatted);
        }

        // Number formatting and display functions
        function convertToNumberLang(numStr) {
            // ANSI uses English digits with SutonnyMJ font, so no conversion needed
            if (currentFormat === 'english' || currentFormat === 'bangla-ansi') {
                return numStr;
            }
            
            // Only Unicode needs digit conversion
            const digits = banglaUnicodeDigits;
            let result = '';
            
            for (let char of numStr) {
                if (char >= '0' && char <= '9') {
                    result += digits[parseInt(char)];
                } else {
                    result += char;
                }
            }
            
            return result;
        }

        function formatNumber(num) {
            const numStr = num.toString();
            let formatted = '';
            
            switch(currentNumberFormat) {
                case 'plain':
                    formatted = numStr;
                    break;
                
                case 'comma':
                    const parts = numStr.split('.');
                    let intPart = parts[0];
                    const decPart = parts[1] ? '.' + parts[1] : '';
                    
                    let lastThree = intPart.substring(intPart.length - 3);
                    let otherNumbers = intPart.substring(0, intPart.length - 3);
                    
                    if (otherNumbers !== '') {
                        lastThree = ',' + lastThree;
                    }
                    
                    let result = otherNumbers.replace(/\B(?=(\d{2})+(?!\d))/g, ',') + lastThree;
                    formatted = result + decPart;
                    break;
                
                case 'comma-slash':
                    const commaSlashParts = numStr.split('.');
                    let commaSlashIntPart = commaSlashParts[0];
                    
                    let commaSlashLastThree = commaSlashIntPart.substring(commaSlashIntPart.length - 3);
                    let commaSlashOtherNumbers = commaSlashIntPart.substring(0, commaSlashIntPart.length - 3);
                    
                    if (commaSlashOtherNumbers !== '') {
                        commaSlashLastThree = ',' + commaSlashLastThree;
                    }
                    
                    let commaSlashResult = commaSlashOtherNumbers.replace(/\B(?=(\d{2})+(?!\d))/g, ',') + commaSlashLastThree;
                    formatted = commaSlashResult + '/-';
                    break;
                
                case 'slash':
                    formatted = numStr + '/-';
                    break;
                
                case 'taka':
                    const commaParts = numStr.split('.');
                    let commaIntPart = commaParts[0];
                    const commaDecPart = commaParts[1] ? '.' + commaParts[1] : '';
                    
                    let lastThreeComma = commaIntPart.substring(commaIntPart.length - 3);
                    let otherNumbersComma = commaIntPart.substring(0, commaIntPart.length - 3);
                    
                    if (otherNumbersComma !== '') {
                        lastThreeComma = ',' + lastThreeComma;
                    }
                    
                    let commaResult = otherNumbersComma.replace(/\B(?=(\d{2})+(?!\d))/g, ',') + lastThreeComma;
                    formatted = '‡ß≥' + commaResult + commaDecPart;
                    break;
                
                default:
                    formatted = numStr;
            }
            
            // Convert to selected output format language
            return convertToNumberLang(formatted);
        }

        function selectNumberFormat(format) {
            currentNumberFormat = format;
            localStorage.setItem('numberDisplayFormat', format);
            updateActiveNumberFormatButton(format);
            
            // Update display if result is showing
            if (lastNumber) {
                updateNumberDisplay();
            }
        }

        function updateNumberDisplay() {
            if (!lastNumber) return;
            
            const resultNumElement = document.getElementById('resultNumber');
            resultNumElement.textContent = formatNumber(lastNumber);
            
            // Apply SutonnyMJ font for Bangla ANSI numbers
            if (currentFormat === 'bangla-ansi') {
                resultNumElement.style.fontFamily = "'SutonnyMJ', 'Roboto', sans-serif";
            } else {
                resultNumElement.style.fontFamily = "'Roboto', sans-serif";
            }
        }

        // Bangla ANSI conversion tables (matching VBA code exactly)
        const banglaAnsiMap = {
            // Single digits (1-9)
            1: 'GK', 2: '`yB', 3: 'wZb', 4: 'Pvi', 5: 'cvuP', 
            6: 'Qq', 7: 'mvZ', 8: 'AvU', 9: 'bq',
            
            // Tens (10-99) - Complete mapping
            10: '`k', 11: 'GMvi', 12: 'evi', 13: '‚Ä†Zi', 14: '‚Ä†P≈†√è',
            15: 'c‚Ä°bi', 16: '‚Ä†lvj', 17: 'm‚Ä°Zi', 18: 'AvVvi', 19: 'Ewbk',
            
            20: 'wek', 21: 'GKzk', 22: 'evBk', 23: '‚Ä†ZBk', 24: 'Pwe≈∏k',
            25: 'cuwPk', 26: 'Qvwe≈∏k', 27: 'mvZvk', 28: 'AvVvk', 29: 'Ebw√ék',
            
            30: 'w√ék', 31: 'GKw√ék', 32: 'ew√ék', 33: '‚Ä†Zw√ék', 34: '‚Ä†P≈†w√ék',
            35: 'cuqw√ék', 36: 'Qw√ék', 37: 'mvuBw√ék', 38: 'AvUw√ék', 39: 'EbPwj√∏k',
            
            40: 'Pwj√∏k', 41: 'GKPwj√∏k', 42: 'weqvwj√∏k', 43: '‚Ä†ZZvwj√∏k', 44: 'Pzqvwj√∏k',
            45: 'cuqZvwj√∏k', 46: '‚Ä†QPwj√∏k', 47: 'mvZPwj√∏k', 48: 'AvUPwj√∏k', 49: 'Ebc√Çvk',
            
            50: 'c√Çvk', 51: 'GKvb≈ì', 52: 'evqvb≈ì', 53: 'wZ√†vb≈ì', 54: 'Pzqvb≈ì',
            55: 'c√Çvb≈ì', 56: 'Qv√†vb≈ì', 57: 'mvZvb≈ì', 58: 'AvUvb≈ì', 59: 'EblvU',
            
            60: 'lvU', 61: 'GKlw√Ü', 62: 'evlw√Ü', 63: '‚Ä†Zlw√Ü', 64: '‚Ä†P≈†lw√Ü',
            65: 'cuqlw√Ü', 66: '‚Ä†Qlw√Ü', 67: 'mvZlw√Ü', 68: 'AvUlw√Ü', 69: 'Ebm√ãi',
            
            70: 'm√ãi', 71: 'GKv√ãi', 72: 'evnv√ãi', 73: 'wZqv√ãi', 74: 'Pzqv√ãi',
            75: 'cuPv√ãi', 76: 'wQqv√ãi', 77: 'mvZv√ãi', 78: 'AvUv√ãi', 79: 'EbAvwk',
            
            80: 'Avwk', 81: 'GKvwk', 82: 'weivwk', 83: 'wZivwk', 84: 'Pzivwk',
            85: 'cuPvwk', 86: 'wQqvwk', 87: 'mvZvwk', 88: 'AvUvwk', 89: 'Ebbe≈∏B',
            
            90: 'be≈∏B', 91: 'GKvbe≈∏B', 92: 'weivbe≈∏B', 93: 'wZivbe≈∏B', 94: 'Pzivbe≈∏B',
            95: 'cuPvbe≈∏B', 96: 'wQqvbe≈∏B', 97: 'mvZvbe≈∏B', 98: 'AvUvbe≈∏B', 99: 'wbivbe≈∏B'
        };

        // Segmented control handler
        document.querySelectorAll('.segmented-control button[data-format]').forEach(button => {
            button.addEventListener('click', function() {
                document.querySelectorAll('.segmented-control button[data-format]').forEach(btn => {
                    btn.classList.remove('active');
                });
                this.classList.add('active');
                saveFormat(this.dataset.format);
            });
        });

        // Bangla Unicode conversion tables
        const banglaUnicodeMap = {
            1: '‡¶è‡¶ï', 2: '‡¶¶‡ßÅ‡¶á', 3: '‡¶§‡¶ø‡¶®', 4: '‡¶ö‡¶æ‡¶∞', 5: '‡¶™‡¶æ‡¶Å‡¶ö',
            6: '‡¶õ‡¶Ø‡¶º', 7: '‡¶∏‡¶æ‡¶§', 8: '‡¶Ü‡¶ü', 9: '‡¶®‡¶Ø‡¶º',
            
            10: '‡¶¶‡¶∂', 11: '‡¶è‡¶ó‡¶æ‡¶∞‡ßã', 12: '‡¶¨‡¶æ‡¶∞‡ßã', 13: '‡¶§‡ßá‡¶∞‡ßã', 14: '‡¶ö‡ßå‡¶¶‡ßç‡¶¶',
            15: '‡¶™‡¶®‡ßá‡¶∞‡ßã', 16: '‡¶∑‡ßã‡¶≤‡ßã', 17: '‡¶∏‡¶§‡ßá‡¶∞‡ßã', 18: '‡¶Ü‡¶†‡¶æ‡¶∞‡ßã', 19: '‡¶â‡¶®‡¶ø‡¶∂',
            
            20: '‡¶¨‡¶ø‡¶∂', 21: '‡¶è‡¶ï‡ßÅ‡¶∂', 22: '‡¶¨‡¶æ‡¶á‡¶∂', 23: '‡¶§‡ßá‡¶á‡¶∂', 24: '‡¶ö‡¶¨‡ßç‡¶¨‡¶ø‡¶∂',
            25: '‡¶™‡¶Å‡¶ö‡¶ø‡¶∂', 26: '‡¶õ‡¶æ‡¶¨‡ßç‡¶¨‡¶ø‡¶∂', 27: '‡¶∏‡¶æ‡¶§‡¶æ‡¶∂', 28: '‡¶Ü‡¶†‡¶æ‡¶∂', 29: '‡¶â‡¶®‡¶§‡ßç‡¶∞‡¶ø‡¶∂',
            
            30: '‡¶§‡ßç‡¶∞‡¶ø‡¶∂', 31: '‡¶è‡¶ï‡¶§‡ßç‡¶∞‡¶ø‡¶∂', 32: '‡¶¨‡¶§‡ßç‡¶∞‡¶ø‡¶∂', 33: '‡¶§‡ßá‡¶§‡ßç‡¶∞‡¶ø‡¶∂', 34: '‡¶ö‡ßå‡¶§‡ßç‡¶∞‡¶ø‡¶∂',
            35: '‡¶™‡¶Å‡¶Ø‡¶º‡¶§‡ßç‡¶∞‡¶ø‡¶∂', 36: '‡¶õ‡¶§‡ßç‡¶∞‡¶ø‡¶∂', 37: '‡¶∏‡¶æ‡¶Å‡¶á‡¶§‡ßç‡¶∞‡¶ø‡¶∂', 38: '‡¶Ü‡¶ü‡¶§‡ßç‡¶∞‡¶ø‡¶∂', 39: '‡¶â‡¶®‡¶ö‡¶≤‡ßç‡¶≤‡¶ø‡¶∂',
            
            40: '‡¶ö‡¶≤‡ßç‡¶≤‡¶ø‡¶∂', 41: '‡¶è‡¶ï‡¶ö‡¶≤‡ßç‡¶≤‡¶ø‡¶∂', 42: '‡¶¨‡¶ø‡¶Ø‡¶º‡¶æ‡¶≤‡ßç‡¶≤‡¶ø‡¶∂', 43: '‡¶§‡ßá‡¶§‡¶æ‡¶≤‡ßç‡¶≤‡¶ø‡¶∂', 44: '‡¶ö‡ßÅ‡¶Ø‡¶º‡¶æ‡¶≤‡ßç‡¶≤‡¶ø‡¶∂',
            45: '‡¶™‡¶Å‡¶Ø‡¶º‡¶§‡¶æ‡¶≤‡ßç‡¶≤‡¶ø‡¶∂', 46: '‡¶õ‡ßá‡¶ö‡¶≤‡ßç‡¶≤‡¶ø‡¶∂', 47: '‡¶∏‡¶æ‡¶§‡¶ö‡¶≤‡ßç‡¶≤‡¶ø‡¶∂', 48: '‡¶Ü‡¶ü‡¶ö‡¶≤‡ßç‡¶≤‡¶ø‡¶∂', 49: '‡¶â‡¶®‡¶™‡¶û‡ßç‡¶ö‡¶æ‡¶∂',
            
            50: '‡¶™‡¶û‡ßç‡¶ö‡¶æ‡¶∂', 51: '‡¶è‡¶ï‡¶æ‡¶®‡ßç‡¶®', 52: '‡¶¨‡¶æ‡¶Ø‡¶º‡¶æ‡¶®‡ßç‡¶®', 53: '‡¶§‡¶ø‡¶™‡ßç‡¶™‡¶æ‡¶®‡ßç‡¶®', 54: '‡¶ö‡ßÅ‡¶Ø‡¶º‡¶æ‡¶®‡ßç‡¶®',
            55: '‡¶™‡¶û‡ßç‡¶ö‡¶æ‡¶®‡ßç‡¶®', 56: '‡¶õ‡¶æ‡¶™‡ßç‡¶™‡¶æ‡¶®‡ßç‡¶®', 57: '‡¶∏‡¶æ‡¶§‡¶æ‡¶®‡ßç‡¶®', 58: '‡¶Ü‡¶ü‡¶æ‡¶®‡ßç‡¶®', 59: '‡¶â‡¶®‡¶∑‡¶æ‡¶ü',
            
            60: '‡¶∑‡¶æ‡¶ü', 61: '‡¶è‡¶ï‡¶∑‡¶ü‡ßç‡¶ü‡¶ø', 62: '‡¶¨‡¶æ‡¶∑‡¶ü‡ßç‡¶ü‡¶ø', 63: '‡¶§‡ßá‡¶∑‡¶ü‡ßç‡¶ü‡¶ø', 64: '‡¶ö‡ßå‡¶∑‡¶ü‡ßç‡¶ü‡¶ø',
            65: '‡¶™‡¶Å‡¶Ø‡¶º‡¶∑‡¶ü‡ßç‡¶ü‡¶ø', 66: '‡¶õ‡ßá‡¶∑‡¶ü‡ßç‡¶ü‡¶ø', 67: '‡¶∏‡¶æ‡¶§‡¶∑‡¶ü‡ßç‡¶ü‡¶ø', 68: '‡¶Ü‡¶ü‡¶∑‡¶ü‡ßç‡¶ü‡¶ø', 69: '‡¶â‡¶®‡¶∏‡¶§‡ßç‡¶§‡¶∞',
            
            70: '‡¶∏‡¶§‡ßç‡¶§‡¶∞', 71: '‡¶è‡¶ï‡¶æ‡¶§‡ßç‡¶§‡¶∞', 72: '‡¶¨‡¶æ‡¶π‡¶æ‡¶§‡ßç‡¶§‡¶∞', 73: '‡¶§‡¶ø‡¶Ø‡¶º‡¶æ‡¶§‡ßç‡¶§‡¶∞', 74: '‡¶ö‡ßÅ‡¶Ø‡¶º‡¶æ‡¶§‡ßç‡¶§‡¶∞',
            75: '‡¶™‡¶Å‡¶ö‡¶æ‡¶§‡ßç‡¶§‡¶∞', 76: '‡¶õ‡¶ø‡¶Ø‡¶º‡¶æ‡¶§‡ßç‡¶§‡¶∞', 77: '‡¶∏‡¶æ‡¶§‡¶æ‡¶§‡ßç‡¶§‡¶∞', 78: '‡¶Ü‡¶ü‡¶æ‡¶§‡ßç‡¶§‡¶∞', 79: '‡¶â‡¶®‡¶Ü‡¶∂‡¶ø',
            
            80: '‡¶Ü‡¶∂‡¶ø', 81: '‡¶è‡¶ï‡¶æ‡¶∂‡¶ø', 82: '‡¶¨‡¶ø‡¶∞‡¶æ‡¶∂‡¶ø', 83: '‡¶§‡¶ø‡¶∞‡¶æ‡¶∂‡¶ø', 84: '‡¶ö‡ßÅ‡¶∞‡¶æ‡¶∂‡¶ø',
            85: '‡¶™‡¶Å‡¶ö‡¶æ‡¶∂‡¶ø', 86: '‡¶õ‡¶ø‡¶Ø‡¶º‡¶æ‡¶∂‡¶ø', 87: '‡¶∏‡¶æ‡¶§‡¶æ‡¶∂‡¶ø', 88: '‡¶Ü‡¶ü‡¶æ‡¶∂‡¶ø', 89: '‡¶â‡¶®‡¶®‡¶¨‡ßç‡¶¨‡¶á',
            
            90: '‡¶®‡¶¨‡ßç‡¶¨‡¶á', 91: '‡¶è‡¶ï‡¶æ‡¶®‡¶¨‡ßç‡¶¨‡¶á', 92: '‡¶¨‡¶ø‡¶∞‡¶æ‡¶®‡¶¨‡ßç‡¶¨‡¶á', 93: '‡¶§‡¶ø‡¶∞‡¶æ‡¶®‡¶¨‡ßç‡¶¨‡¶á', 94: '‡¶ö‡ßÅ‡¶∞‡¶æ‡¶®‡¶¨‡ßç‡¶¨‡¶á',
            95: '‡¶™‡¶Å‡¶ö‡¶æ‡¶®‡¶¨‡ßç‡¶¨‡¶á', 96: '‡¶õ‡¶ø‡¶Ø‡¶º‡¶æ‡¶®‡¶¨‡ßç‡¶¨‡¶á', 97: '‡¶∏‡¶æ‡¶§‡¶æ‡¶®‡¶¨‡ßç‡¶¨‡¶á', 98: '‡¶Ü‡¶ü‡¶æ‡¶®‡¶¨‡ßç‡¶¨‡¶á', 99: '‡¶®‡¶ø‡¶∞‡¶æ‡¶®‡¶¨‡ßç‡¶¨‡¶á'
        };

        // Segmented control handler
        document.querySelectorAll('.segmented-control button[data-format]').forEach(button => {
            button.addEventListener('click', function() {
                document.querySelectorAll('.segmented-control button[data-format]').forEach(btn => {
                    btn.classList.remove('active');
                });
                this.classList.add('active');
                saveFormat(this.dataset.format);
            });
        });

        // Enter key handler
        document.getElementById('numberInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                convertNumber();
            }
        });

        function showError(message) {
            const errorDiv = document.getElementById('errorMessage');
            errorDiv.textContent = message;
            errorDiv.classList.add('show');
            document.getElementById('resultPanel').classList.remove('show');
        }

        function hideError() {
            document.getElementById('errorMessage').classList.remove('show');
        }

        function convertNumber() {
            hideError();
            const input = document.getElementById('numberInput').value.trim();

            if (!input) {
                showError('Please enter a number');
                return;
            }

            const number = parseFloat(input);
            if (isNaN(number)) {
                showError('Please enter a valid number');
                return;
            }

            if (number < 0) {
                showError('Negative numbers are not supported');
                return;
            }

            if (number >= 10000000000) {
                showError('Number is too large. Maximum: 999 crore');
                return;
            }

            let result = '';
            if (currentFormat === 'english') {
                result = convertToEnglish(number);
            } else if (currentFormat === 'bangla-unicode') {
                result = convertToBanglaUnicode(number);
            } else if (currentFormat === 'bangla-ansi') {
                result = convertToBanglaAnsi(number);
            }

            displayResult(result);
        }

        // Bangla ANSI Conversion (matching VBA logic exactly)
        function convertToBanglaAnsi(num) {
            const parts = num.toString().split('.');
            let myNumber = parts[0];
            let rupees = '';
            let paise = '';

            // Convert paise (decimal part)
            if (parts[1]) {
                const temp = (parts[1] + '00').substring(0, 2);
                paise = convertBanglaAnsiTens(temp);
            }

            let count = 1;
            
            // Convert rupees part
            while (myNumber !== '') {
                let temp = '';
                
                if (count === 1) {
                    // First iteration: take last 3 digits
                    const lastThree = myNumber.slice(-3);
                    temp = convertBanglaAnsiHundreds(lastThree);
                    
                    if (temp !== '') {
                        rupees = temp + rupees;
                    }
                    
                    if (myNumber.length > 3) {
                        myNumber = myNumber.substring(0, myNumber.length - 3);
                    } else {
                        myNumber = '';
                    }
                } else {
                    // Subsequent iterations: take last 2 digits
                    if (myNumber.length === 1) {
                        temp = convertBanglaAnsiDigit(myNumber);
                    } else {
                        const lastTwo = myNumber.slice(-2);
                        temp = convertBanglaAnsiTens(lastTwo);
                    }
                    
                    const places = ['', '', ' nvRvi ', ' j¬∂ ', ' ‚Ä†KvwU '];
                    
                    if (temp !== '') {
                        rupees = temp + places[count] + rupees;
                    }
                    
                    if (myNumber.length >= 2) {
                        myNumber = myNumber.substring(0, myNumber.length - 2);
                    } else {
                        myNumber = '';
                    }
                }
                
                count++;
            }

            // Format output
            let result = '';
            if (rupees !== '') {
                result = rupees.trim() + ' UvKv';
            }
            if (paise !== '') {
                result += ' ' + paise + ' cqmv';
            }
            
            return result.trim() || 'k~b¬®';
        }

        function convertBanglaAnsiHundreds(myNumber) {
            if (parseInt(myNumber) === 0) return '';
            
            myNumber = ('000' + myNumber).slice(-3);
            let result = '';
            
            // Hundreds place
            if (myNumber[0] !== '0') {
                result = convertBanglaAnsiDigit(myNumber[0]) + 'kZ ';
            }
            
            // Tens place
            if (myNumber[1] !== '0') {
                result += convertBanglaAnsiTens(myNumber.substring(1));
            } else {
                result += convertBanglaAnsiDigit(myNumber[2]);
            }
            
            return result.trim();
        }

        function convertBanglaAnsiTens(myTens) {
            const val = parseInt(myTens);
            if (banglaAnsiMap[val]) {
                return banglaAnsiMap[val];
            }
            return '';
        }

        function convertBanglaAnsiDigit(myDigit) {
            const val = parseInt(myDigit);
            if (banglaAnsiMap[val]) {
                return banglaAnsiMap[val];
            }
            return '';
        }

        // Bangla Unicode Conversion (similar structure)
        function convertToBanglaUnicode(num) {
            const parts = num.toString().split('.');
            let myNumber = parts[0];
            let rupees = '';
            let paise = '';

            if (parts[1]) {
                const temp = (parts[1] + '00').substring(0, 2);
                paise = convertBanglaUnicodeTens(temp);
            }

            let count = 1;
            
            while (myNumber !== '') {
                let temp = '';
                
                if (count === 1) {
                    const lastThree = myNumber.slice(-3);
                    temp = convertBanglaUnicodeHundreds(lastThree);
                    
                    if (temp !== '') {
                        rupees = temp + rupees;
                    }
                    
                    if (myNumber.length > 3) {
                        myNumber = myNumber.substring(0, myNumber.length - 3);
                    } else {
                        myNumber = '';
                    }
                } else {
                    if (myNumber.length === 1) {
                        temp = convertBanglaUnicodeDigit(myNumber);
                    } else {
                        const lastTwo = myNumber.slice(-2);
                        temp = convertBanglaUnicodeTens(lastTwo);
                    }
                    
                    const places = ['', '', ' ‡¶π‡¶æ‡¶ú‡¶æ‡¶∞ ', ' ‡¶≤‡¶ï‡ßç‡¶∑ ', ' ‡¶ï‡ßã‡¶ü‡¶ø '];
                    
                    if (temp !== '') {
                        rupees = temp + places[count] + rupees;
                    }
                    
                    if (myNumber.length >= 2) {
                        myNumber = myNumber.substring(0, myNumber.length - 2);
                    } else {
                        myNumber = '';
                    }
                }
                
                count++;
            }

            let result = '';
            if (rupees !== '') {
                result = rupees.trim() + ' ‡¶ü‡¶æ‡¶ï‡¶æ';
            }
            if (paise !== '') {
                result += ' ' + paise + ' ‡¶™‡¶Ø‡¶º‡¶∏‡¶æ';
            }
            
            return result.trim() || '‡¶∂‡ßÇ‡¶®‡ßç‡¶Ø';
        }

        function convertBanglaUnicodeHundreds(myNumber) {
            if (parseInt(myNumber) === 0) return '';
            
            myNumber = ('000' + myNumber).slice(-3);
            let result = '';
            
            if (myNumber[0] !== '0') {
                result = convertBanglaUnicodeDigit(myNumber[0]) + '‡¶∂‡¶§ ';
            }
            
            if (myNumber[1] !== '0') {
                result += convertBanglaUnicodeTens(myNumber.substring(1));
            } else {
                result += convertBanglaUnicodeDigit(myNumber[2]);
            }
            
            return result.trim();
        }

        function convertBanglaUnicodeTens(myTens) {
            const val = parseInt(myTens);
            if (banglaUnicodeMap[val]) {
                return banglaUnicodeMap[val];
            }
            return '';
        }

        function convertBanglaUnicodeDigit(myDigit) {
            const val = parseInt(myDigit);
            if (banglaUnicodeMap[val]) {
                return banglaUnicodeMap[val];
            }
            return '';
        }

        // English Conversion
        function convertToEnglish(num) {
            if (num === 0) return 'zero';

            const parts = num.toString().split('.');
            const integerPart = parseInt(parts[0]);
            let result = convertEnglishInteger(integerPart);

            if (parts[1]) {
                result += ' point';
                const ones = ['zero', 'one', 'two', 'three', 'four', 'five', 'six', 'seven', 'eight', 'nine'];
                for (let digit of parts[1]) {
                    result += ' ' + ones[parseInt(digit)];
                }
            }

            return result.trim();
        }

        function convertEnglishInteger(num) {
            const ones = ['', 'one', 'two', 'three', 'four', 'five', 'six', 'seven', 'eight', 'nine'];
            const teens = ['ten', 'eleven', 'twelve', 'thirteen', 'fourteen', 'fifteen', 'sixteen', 'seventeen', 'eighteen', 'nineteen'];
            const tens = ['', '', 'twenty', 'thirty', 'forty', 'fifty', 'sixty', 'seventy', 'eighty', 'ninety'];

            if (num === 0) return '';

            let result = '';

            // Billions
            if (num >= 1000000000) {
                result += convertEnglishHundreds(Math.floor(num / 1000000000), ones, teens, tens) + ' billion ';
                num %= 1000000000;
            }

            // Millions
            if (num >= 1000000) {
                result += convertEnglishHundreds(Math.floor(num / 1000000), ones, teens, tens) + ' million ';
                num %= 1000000;
            }

            // Thousands
            if (num >= 1000) {
                result += convertEnglishHundreds(Math.floor(num / 1000), ones, teens, tens) + ' thousand ';
                num %= 1000;
            }

            // Hundreds, tens, ones
            if (num > 0) {
                result += convertEnglishHundreds(num, ones, teens, tens);
            }

            return result.trim();
        }

        function convertEnglishHundreds(num, ones, teens, tens) {
            let result = '';

            if (num >= 100) {
                result += ones[Math.floor(num / 100)] + ' hundred ';
                num %= 100;
            }

            if (num >= 10 && num < 20) {
                result += teens[num - 10];
            } else {
                if (num >= 20) {
                    result += tens[Math.floor(num / 10)] + ' ';
                    num %= 10;
                }
                if (num > 0) {
                    result += ones[num];
                }
            }

            return result.trim();
        }

        function displayResult(result) {
            lastResult = result;
            lastNumber = document.getElementById('numberInput').value.trim();
            
            const resultTextElement = document.getElementById('resultText');
            resultTextElement.textContent = result;
            
            // Display formatted number
            updateNumberDisplay();
            
            // Apply SutonnyMJ font for Bangla ANSI
            if (currentFormat === 'bangla-ansi') {
                resultTextElement.classList.add('bangla-ansi');
            } else {
                resultTextElement.classList.remove('bangla-ansi');
            }
            
            const formatLabels = {
                'bangla-unicode': 'Bangla Unicode',
                'english': 'English',
                'bangla-ansi': 'Bangla ANSI'
            };
            document.getElementById('resultLabel').textContent = formatLabels[currentFormat];
            
            document.getElementById('resultPanel').classList.add('show');
            document.body.style.overflow = 'hidden'; // Prevent background scroll
            
            // Reset copy button
            const copyBtn = document.querySelector('.copy-btn');
            copyBtn.classList.remove('copied');
            document.getElementById('copyIcon').textContent = 'üìã';
            document.getElementById('copyText').textContent = 'Copy Words';
            
            // Reset copy number button
            const copyNumBtn = document.querySelectorAll('.copy-btn')[1];
            if (copyNumBtn) {
                copyNumBtn.classList.remove('copied');
                document.getElementById('copyNumberIcon').textContent = 'üî¢';
                document.getElementById('copyNumberText').textContent = 'Copy Number';
            }
        }

        function closePopup() {
            document.getElementById('resultPanel').classList.remove('show');
            document.body.style.overflow = 'auto'; // Restore scroll
        }

        function closePopupOnBackdrop(event) {
            if (event.target.id === 'resultPanel') {
                closePopup();
            }
        }

        function clearForm() {
            document.getElementById('numberInput').value = '';
            hideError();
            closePopup();
            document.getElementById('numberInput').focus();
        }

        function copyResult() {
            navigator.clipboard.writeText(lastResult).then(() => {
                const copyBtn = document.querySelector('.copy-btn');
                copyBtn.classList.add('copied');
                document.getElementById('copyIcon').textContent = '‚úÖ';
                document.getElementById('copyText').textContent = 'Copied!';

                setTimeout(() => {
                    copyBtn.classList.remove('copied');
                    document.getElementById('copyIcon').textContent = 'üìã';
                    document.getElementById('copyText').textContent = 'Copy Words';
                }, 2000);
            }).catch(err => {
                showError('Failed to copy to clipboard');
            });
        }

        function copyNumber() {
            const formattedNum = formatNumber(lastNumber);
            navigator.clipboard.writeText(formattedNum).then(() => {
                const copyNumBtn = document.querySelectorAll('.copy-btn')[1];
                copyNumBtn.classList.add('copied');
                document.getElementById('copyNumberIcon').textContent = '‚úÖ';
                document.getElementById('copyNumberText').textContent = 'Copied!';

                setTimeout(() => {
                    copyNumBtn.classList.remove('copied');
                    document.getElementById('copyNumberIcon').textContent = 'üî¢';
                    document.getElementById('copyNumberText').textContent = 'Copy Number';
                }, 2000);
            }).catch(err => {
                showError('Failed to copy to clipboard');
            });
        }

        // ESC key to close popup
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                closePopup();
            }
        });
    </script>
</body>
</html>